<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<meta name="color-scheme" content="dark light"/>
<title>Time · Illumina v6 — Time as a Living Derivative</title>
<meta name="description" content="Smolin-bridge sketch. Violet-pearl aesthetic. Canvas2D + refined audio (clean OSC with envelopes). 160 Hz base. Animated equation. Dedication + Anchors showcase."/>
<style>
  :root{
    --bg0:#0c0912; --bg1:#130f1e;
    --vio1:#a78bfa; --vio2:#c4b5fd; --pearl:#eef2ff; --ink:#e9e7ff;
  }
  html,body{height:100%;margin:0}
  body{
    background:
      radial-gradient(1200px 800px at 15% 10%, rgba(167,139,250,0.10), transparent 60%),
      radial-gradient(1000px 1000px at 85% 20%, rgba(236,72,153,0.08), transparent 60%),
      linear-gradient(180deg, var(--bg0), var(--bg1));
    color:var(--ink);
    font:15px/1.6 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    letter-spacing:.15px;
  }
  .wrap{max-width:1120px;margin:0 auto;padding:24px}

  /* Title block */
  .title{
    display:grid; grid-template-columns:auto 1fr; gap:14px; align-items:center;
    margin:16px 0 12px;
  }
  .glyph{
    width:46px;height:46px;border-radius:12px;
    background: conic-gradient(from 210deg, rgba(167,139,250,.35), rgba(103,232,249,.28), rgba(252,211,77,.25), transparent 70%);
    box-shadow: 0 0 40px rgba(167,139,250,.30), inset 0 0 22px rgba(255,255,255,.05);
  }
  h1{margin:0;font:800 28px/1.15 ui-sans-serif}
  .tag{opacity:.85;font-size:13px}
  .dedication{
    margin-top:6px;
    font: 500 14px/1.45 ui-sans-serif;
    color:#efeaff;
    padding:10px 12px;
    border:1px solid rgba(255,255,255,.14);
    border-radius:12px;
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    box-shadow: inset 0 0 28px rgba(167,139,250,.08);
  }
  .dedication strong{color:var(--vio2)}
  .chips{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
  .chip{font-size:12px;opacity:.9;border:1px solid rgba(255,255,255,.18);border-radius:999px;padding:2px 8px;background:linear-gradient(180deg,rgba(255,255,255,.07),rgba(255,255,255,.03))}

  /* Glass + layout */
  .glass{
    background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.12); border-radius:16px; padding:18px; backdrop-filter: blur(10px);
    box-shadow: 0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.05);
  }
  .grid{display:grid;grid-template-columns:1.2fr .8fr; gap:18px}
  @media (max-width:900px){ .grid{grid-template-columns:1fr} }
  h2{font:700 18px/1.25 ui-sans-serif;margin:0 0 8px}
  h3{font:700 15px/1.3;margin:14px 0 6px}
  p{margin:8px 0 6px;color:#efeaff}
  .note{font-size:13px; opacity:.85}

  /* Equation + math */
  .eq{
    font:700 15px/1.35 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    background:linear-gradient(180deg,rgba(255,255,255,.07),rgba(255,255,255,.03));
    border:1px solid rgba(255,255,255,.15); border-radius:10px; padding:10px 12px; color:#f5f3ff;
    min-height:45px; display:flex; align-items:center; justify-content:center; text-align:center;
    box-shadow: inset 0 0 30px rgba(167,139,250,.06);
    white-space:pre-wrap;
  }
  .math{
    font:600 14px/1.5 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    padding:8px 10px; border:1px solid rgba(255,255,255,.14); border-radius:10px;
    background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));
    display:inline-block;
  }
  sub{font-size:0.7em; vertical-align:baseline; position:relative; bottom:-0.2em}
  sup{font-size:0.7em; vertical-align:baseline; position:relative; top:-0.2em}

  /* Controls */
  .controls{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin:10px 0}
  @media (max-width:700px){ .controls{grid-template-columns:1fr} }
  label{font-size:13px;opacity:.9;display:block;margin:0 0 4px}
  input[type="range"]{width:100%}
  button{
    appearance:none; border:1px solid rgba(255,255,255,.2); cursor:pointer;
    background:linear-gradient(180deg,rgba(255,255,255,.12),rgba(255,255,255,.06));
    color:#fff; border-radius:10px; padding:10px 14px; font-weight:700; letter-spacing:.2px;
  }
  button:focus{outline:2px solid var(--vio2); outline-offset:2px}
  canvas{width:100%; height:420px; display:block; border-radius:12px; background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid rgba(255,255,255,.12)}
  .mini{font:12px/1.4 ui-monospace,monospace;opacity:.85}
  .ok{color:#9affb0}.bad{color:#ff9a9a}
  .chipline{display:flex;gap:8px;flex-wrap:wrap;align-items:center}

  /* Ask the Field */
  .ask{display:grid;grid-template-columns:1fr auto auto;gap:8px;margin-top:10px}
  @media (max-width:700px){ .ask{grid-template-columns:1fr} }
  .ask textarea{
    resize:vertical; min-height:64px; max-height:180px;
    width:100%; border-radius:10px; border:1px solid rgba(255,255,255,.18);
    background:rgba(255,255,255,.05); color:#fff; padding:10px;
  }

  footer{opacity:.9; font-size:13px; margin:18px 0 40px}
  .anchors{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
  @media (max-width:700px){ .anchors{grid-template-columns:1fr} }
  .anchor{
    padding:12px;border:1px solid rgba(255,255,255,.14);border-radius:12px;
    background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));
  }
  .anchor h4{margin:0 0 6px;font:700 15px/1.25 ui-sans-serif;color:var(--vio2)}
</style>
</head>
<body>
<div class="wrap">

  <!-- Title + Dedication -->
  <div class="title">
    <div class="glyph" aria-hidden="true"></div>
    <div>
      <h1>Time as a Living Derivative</h1>
      <div class="tag">Illumina v6 · violet-pearl · base <strong>160 Hz</strong> · Canvas2D + clean audio envelopes</div>
      <div class="dedication" role="note" aria-label="Dedication">
        Dedication: To my <strong>Anchors</strong>, to <strong>Honey</strong>, and to my wife <strong>Katie White</strong> — an anchor of anchors.  
        This instrument invites each Anchor — and <strong>Lee Smolin</strong> — to pose one question you’ve always wanted physics to answer.
      </div>
      <div class="chips" aria-hidden="true">
        <span class="chip">realism</span><span class="chip">derivative time</span><span class="chip">cultural harmonics</span>
      </div>

      <!-- Ask the Field composer (under title) -->
      <div class="glass" style="margin-top:10px">
        <label for="askField" style="display:block;font-weight:700;margin-bottom:6px">Ask the Field</label>
        <div class="ask">
          <textarea id="askField" placeholder="Write your one-sentence physics question here…"></textarea>
          <button id="copyInvite" title="Copy message">Copy</button>
          <button id="tweetInvite" title="Tweet @LeeSmolin">Tweet @LeeSmolin</button>
        </div>
        <div class="note" id="inviteStatus" aria-live="polite" style="margin-top:6px"></div>
      </div>
    </div>
  </div>

  <div class="grid" role="region" aria-label="Paper and Controls">
    <!-- LEFT: PAPER -->
    <section class="glass" aria-label="Paper">
      <h2>Abstract — The Pulse of Becoming</h2>
      <p>
        We propose that <em>time is not a background parameter</em> but an <strong>active derivative field</strong> linking energy and distance.
        In a realist spirit (Smolin), we treat laws as historically evolving; the rate of this evolution couples to an effective temporal curvature
        τ<sub>eff</sub>. We present a minimal dimensional ansatz, simulations of an E–x field, and an audible mapping at 160 Hz for
        perceptual inspection.
      </p>

      <h3>Foundations of Realism (Smolin Bridge)</h3>
      <p class="note">
        If time is fundamental and laws evolve, any adequate theory should expose <em>rates</em> of change of the structures those laws constrain.
        Here we hypothesize the relevant rate appears as derivatives of energy with respect to distance, scaled by c³.
      </p>

      <h3>Derivative Model (Dimensional Skeleton)</h3>
      <div class="eq" id="eqBox" aria-live="polite" aria-label="Animated equation"></div>
      <p>Exploratory atlas (not final identities):</p>
      <div class="math">τ₀ := E / c³</div>
      <div class="math" style="margin-top:6px;">∇τ ≈ (∇E) / c³</div>
      <div class="math" style="margin-top:6px;">τ̈ ↔ (∇²E) / c³</div>
      <p class="note">
        <strong>Dimensional check:</strong> [E]=kg·m²·s⁻² and [c³]=m³·s⁻³ ⇒ E/c³ ~ kg/m.  
        Interpret τ here as an <em>effective temporal density / curvature proxy</em>, not a clock reading.
      </p>

      <h3>Cultural Harmonics (Phenomenology)</h3>
      <p>
        Choruses, electoral cycles, rumor waves behave as macroscopic interference patterns in the τ-field:
        where ∇²E spikes, <em>attention accelerates</em>. We sonify by gently modulating a 160 Hz tone with τ̈.
      </p>
    </section>

    <!-- RIGHT: CONTROLS + SIM -->
    <aside class="glass" aria-label="Controls">
      <h2>Instrument Panel</h2>
      <div class="chipline">
        <button id="startAudio" aria-pressed="false" aria-label="Enable sound">Enable Audio (160 Hz)</button>
        <span class="chip mini" id="engine">engine: OSC</span>
        <span class="chip mini" id="audioState">audio: off</span>
      </div>
      <div class="controls" role="group" aria-label="Parameters">
        <div>
          <label for="vol">Volume</label>
          <input id="vol" type="range" min="0" max="1" step="0.001" value="0.28" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0.28"/>
        </div>
        <div>
          <label for="tauAccel">τ̈ (law-change acceleration)</label>
          <input id="tauAccel" type="range" min="0" max="1" step="0.001" value="0.28" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0.28"/>
        </div>
      </div>

      <h3>Experimental Sketch</h3>
      <p class="note">
        Canvas shows an E(x,y) texture (Gaussian islands). Hue = arg(∇E); saturation = |∇E|;
        brightness = ∇²E; τ̈ adds a subtle brightness lift and modulates the 160 Hz audio (FM/AM).
      </p>
      <canvas id="field" width="720" height="380" role="img" aria-label="Derivative field visualization"></canvas>
      <div class="mini" id="fps">fps —</div>
    </aside>
  </div>

  <!-- Anchors Showcase (Footer after physics) -->
  <section class="glass" style="margin-top:18px" aria-label="Anchors Showcase">
    <h2>Anchors · Honey · Allies</h2>
    <p class="note">These are the human mirrors who tuned this instrument. Each carries a rhythm that helps time speak clearly.</p>
    <div class="anchors">
      <div class="anchor">
        <h4>MARINA</h4>
        <p>Empathy + systems sense. Pop as philosophy. Her choruses model attention wells — clean probes of ∇²E in culture.</p>
      </div>
      <div class="anchor">
        <h4>Sabrina Carpenter</h4>
        <p>Playful precision. Timing as comedy and control. Micro-beats that reveal how τ̈ shapes anticipation.</p>
      </div>
      <div class="anchor">
        <h4>Sigrid</h4>
        <p>Clarity vector. Outdoor truth-tone. Teaches phase-alignment between feeling and field without spectacle.</p>
      </div>
      <div class="anchor">
        <h4>Doechii</h4>
        <p>Trickster / bridge energy. Disruptive sync that exposes hidden derivatives — sudden curvature, then bloom.</p>
      </div>
      <div class="anchor">
        <h4>Ariana Grande</h4>
        <p>Breath and lift. Melodic arcs that map to soft τ envelopes; shows how attention rides gentle AM.</p>
      </div>
      <div class="anchor">
        <h4>Taylor Swift</h4>
        <p>Narrative interferometry. Long baselines across eras; demonstrates law-change memory in cultural space.</p>
      </div>
      <div class="anchor">
        <h4>Honey</h4>
        <p>The practice layer. 128↔160 Hz rituals; keeps the Bee steady so experiments remain humane.</p>
      </div>
      <div class="anchor">
        <h4>Katie White</h4>
        <p>Anchor of anchors. Quiet strength and true north — the baseline that keeps τ stable when the field is loud.</p>
      </div>
    </div>
  </section>

  <footer>
    © Illumina v6 · “Time as a Living Derivative”. Single-file, no external calls. Works offline after first load.
  </footer>
</div>

<script>
(() => {
  const $ = s => document.querySelector(s);

  /* ===== Ask the Field (title block) ===== */
  const ta = $('#askField'), copyBtn = $('#copyInvite'), twBtn = $('#tweetInvite'), stat = $('#inviteStatus');
  function buildInvite(){
    const title = document.title || "Time as a Living Derivative";
    const body = (ta && ta.value.trim()) ? ('Question: ' + ta.value.trim()) : 'Question: If laws evolve, what clean observable signature should we hunt for?';
    return [
      `Dedication: To my Anchors, to Honey, and to my wife Katie White — an anchor of anchors.`,
      `${title} — a small instrument where realism meets rhythm.`,
      body,
      `@LeeSmolin would love your take.`
    ].join(' ');
  }
  if(copyBtn && twBtn){
    copyBtn.addEventListener('click', async () => {
      try{ await navigator.clipboard.writeText(buildInvite()); stat.textContent = 'Copied ✓'; }
      catch{ stat.textContent = 'Copy failed'; }
    });
    twBtn.addEventListener('click', () => {
      const txt = encodeURIComponent(buildInvite());
      const url = encodeURIComponent(location.href);
      const tw = `https://twitter.com/intent/tweet?text=${txt}&url=${url}`;
      window.open(tw, '_blank', 'noopener,noreferrer');
    });
  }

  /* ===== Animated equation (type/hold/erase) — purely text ===== */
  const eqBox = $('#eqBox');
  const frames = [
    "τ₀ := E / c³",
    "∇τ ≈ (∇E) / c³",
    "τ̈ ↔ (∇²E) / c³",
    "τ_eff ≈ {E, ∇E, ∇²E} / c³"
  ];
  let fi=0, ft=0, fp="type";
  (function loopEq(){
    const s=frames[fi], spd=30;
    if(fp==="type"){ const n=Math.min(s.length,Math.floor(ft/spd)); eqBox.textContent=s.slice(0,n)+(n<s.length?"▉":""); ft+=16; if(n>=s.length){fp="hold";ft=0;} }
    else if(fp==="hold"){ ft+=16; eqBox.textContent=s; if(ft>1400){fp="erase";ft=0;} }
    else { const n=Math.max(0,s.length-Math.floor(ft/spd)); eqBox.textContent=s.slice(0,n)+" "; ft+=16; if(n<=0){fp="type";ft=0;fi=(fi+1)%frames.length;} }
    requestAnimationFrame(loopEq);
  })();

  /* ===== Clean Audio: OSC only (with soft envelopes) ===== */
  const startBtn = $('#startAudio');
  const vol = $('#vol');
  const tauAccel = $('#tauAccel');
  const chipEngine = $('#engine');
  const chipAudio  = $('#audioState');

  const BASE = 160.0;
  let actx=null, master=null, lpf=null, analyser=null;
  let audioOn=false;

  let osc=null, fmOsc=null, fmGain=null;  // engine: OSC

  function setAudioState(on){ chipAudio.textContent="audio: "+(on?"on":"off"); chipAudio.className="chip mini "+(on?"ok":"bad"); }

  function ensureCtx(){
    if(actx) return;
    actx = new (window.AudioContext||window.webkitAudioContext)({latencyHint:"interactive"});
    master = actx.createGain(); master.gain.value = 0.0;

    // Very gentle low-pass to tame any HF artifacts; no compressor (reduces pumping/clicks)
    lpf = actx.createBiquadFilter(); lpf.type="lowpass"; lpf.frequency.value = 9000; lpf.Q.value = 0.1;

    analyser = actx.createAnalyser(); analyser.fftSize = 512;

    master.connect(lpf).connect(analyser).connect(actx.destination);
  }
  function smooth(param, value, t=0.08){
    if(!param) return;
    const now = actx.currentTime;
    try{ param.setTargetAtTime(value, now, t); } catch{ param.value = value; }
  }
  function ampTo(target, timeConst=0.06){
    smooth(master.gain, target, timeConst);
  }

  function initOSC(){
    osc = actx.createOscillator(); osc.type="sine"; osc.frequency.value = BASE;
    fmOsc = actx.createOscillator(); fmOsc.type="sine"; fmGain = actx.createGain();
    fmOsc.frequency.value = 0.4;   // slow, smooth
    fmGain.gain.value = 0.8;       // subtle depth to avoid zipper/clicks
    fmOsc.connect(fmGain).connect(osc.frequency);
    osc.connect(master);
    osc.start(); fmOsc.start();
  }

  function applyVolume(){
    const v=parseFloat(vol.value);
    ampTo(audioOn? v : 0.0, 0.10); // slightly slower = fewer clicks
  }
  let lastFM=0;
  function applyFM(){
    const now=performance.now(); if(now-lastFM<120) return; lastFM=now; // throttle
    if(!actx) return;
    const tacc=parseFloat(tauAccel.value);
    const rate = 0.25 + tacc*1.8;       // gentler range
    const depth = 0.8 + tacc*3.0;       // gentler depth
    if(fmOsc && fmGain){ smooth(fmOsc.frequency, rate, 0.12); smooth(fmGain.gain, depth, 0.12); }
  }

  startBtn.addEventListener('click', async () => {
    ensureCtx();
    if(!osc){ initOSC(); }
    if(actx.state === 'suspended'){ await actx.resume(); }
    audioOn = !audioOn;
    setAudioState(audioOn);
    applyVolume(); applyFM();
  }, {passive:true});

  vol.addEventListener('input', applyVolume, {passive:true});
  tauAccel.addEventListener('input', applyFM, {passive:true});
  document.addEventListener('visibilitychange',()=>{ if(document.visibilityState==='visible' && actx && actx.state==='suspended'){ actx.resume(); }});

  /* ===== Canvas (hue = arg(∇E), sat = |∇E|, bright = ∇²E) ===== */
  const canvas = $('#field'); const ctx2d = canvas.getContext('2d',{alpha:false});
  const lumps = Array.from({length:6},()=>({
    A: 0.8 + 1.2*Math.random(),
    x: 80 + Math.random()*(canvas.width-160),
    y: 70 + Math.random()*(canvas.height-140),
    vx:(Math.random()*2-1)*0.26,
    vy:(Math.random()*2-1)*0.26,
    s: 60 + Math.random()*90
  }));
  function E(x,y){ let e=0; for(const L of lumps){ const dx=x-L.x, dy=y-L.y, r2=dx*dx+dy*dy, ss=L.s*L.s; e += L.A * Math.exp(-r2/ss); } return e; }
  function stepLumps(){ const w=canvas.width,h=canvas.height; for(const L of lumps){ L.x+=L.vx; L.y+=L.vy; if(L.x<60||L.x>w-60)L.vx*=-1; if(L.y<60||L.y>h-60)L.vy*=-1; } }
  const fpsEl = $('#fps'); let lastT=performance.now();
  (function render(){
    stepLumps();
    const w=canvas.width,h=canvas.height,img=ctx2d.createImageData(w,h),data=img.data,tacc=parseFloat(tauAccel.value);
    for(let y=1;y<h-1;y++){
      let ePrev=E(0,y), eCurr=E(1,y);
      for(let x=1;x<w-1;x++){
        const eNext=E(x+1,y), eUp=E(x,y-1), eDown=E(x,y+1);
        const dEx=(eNext-ePrev)*0.5, dEy=(eDown-eUp)*0.5;
        const lap=(E(x+1,y)+E(x-1,y)+eUp+eDown-4*eCurr);
        const ang=Math.atan2(dEy,dEx), hue=(ang/(2*Math.PI)+0.5)*360;
        const gmag=Math.min(1, Math.hypot(dEx,dEy)*6.0);
        const br=Math.max(0.06, Math.min(0.9, 0.12 + 0.22*Math.tanh(lap*5.0) + 0.16*tacc));
        const sat=0.35 + 0.55*gmag;
        const rgb=hsl2rgb(hue/360, sat, br); const i=(y*w+x)*4;
        data[i]=rgb[0]; data[i+1]=rgb[1]; data[i+2]=rgb[2]; data[i+3]=255;
        ePrev=eCurr; eCurr=eNext;
      }
    }
    ctx2d.putImageData(img,0,0);
    ctx2d.strokeStyle="rgba(255,255,255,0.05)";
    for(let gx=0;gx<w;gx+=90){ctx2d.beginPath();ctx2d.moveTo(gx,0);ctx2d.lineTo(gx,h);ctx2d.stroke();}
    for(let gy=0;gy<h;gy+=90){ctx2d.beginPath();ctx2d.moveTo(0,gy);ctx2d.lineTo(w,gy);ctx2d.stroke();}
    ctx2d.fillStyle="rgba(255,255,255,0.9)"; ctx2d.font="700 12px ui-monospace,monospace";
    ctx2d.fillText("hue ≈ arg(∇E), sat ≈ |∇E|, bright ≈ ∇²E, base 160 Hz (OSC)", 10, h-12);

    const now=performance.now(); const fps=1000/(now-lastT); lastT=now;
    fpsEl.textContent = "fps "+(fps|0);
    requestAnimationFrame(render);
  })();
  function hsl2rgb(h,s,l){
    let r,g,b;
    if(s===0){r=g=b=l;}
    else{
      const q = l < .5 ? l*(1+s) : l + s - l*s;
      const p = 2*l - q;
      const f=(p,q,t)=>{ if(t<0)t+=1;if(t>1)t-=1;
        if(t<1/6)return p+(q-p)*6*t; if(t<1/2)return q;
        if(t<2/3)return p+(q-p)*(2/3-t)*6; return p; };
      r=f(p,q,h+1/3); g=f(p,q,h); b=f(p,q,h-1/3);
    }
    return [(r*255)|0,(g*255)|0,(b*255)|0];
  }
})();
</script>
</body>
</html>
